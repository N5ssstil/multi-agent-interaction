<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Agent Interaction</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- é¡¶éƒ¨å¯¼èˆª -->
        <header class="header">
            <div class="logo">
                <span class="logo-icon">ğŸ¤–</span>
                <span class="logo-text">Multi-Agent</span>
            </div>
            <div class="status">
                <span class="status-dot" :class="{ connected: wsConnected }"></span>
                <span>{{ wsConnected ? 'å·²è¿æ¥' : 'æ–­å¼€è¿æ¥' }}</span>
            </div>
        </header>

        <main class="main">
            <!-- å·¦ä¾§: Agent åˆ—è¡¨ -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h2>Agents</h2>
                    <button class="btn-icon" @click="showCreateAgent = true">+</button>
                </div>
                
                <div class="agent-list">
                    <div 
                        v-for="agent in agents" 
                        :key="agent.name"
                        class="agent-card"
                        :class="{ active: selectedAgent === agent.name }"
                        @click="selectAgent(agent.name)"
                    >
                        <div class="agent-avatar">{{ agent.name.charAt(0) }}</div>
                        <div class="agent-info">
                            <div class="agent-name">{{ agent.name }}</div>
                            <div class="agent-role">{{ agent.role }}</div>
                        </div>
                        <div class="agent-status" :class="agent.state"></div>
                    </div>
                </div>

                <!-- å¿«é€Ÿåˆ›å»º Agent -->
                <div class="quick-create" v-if="showCreateAgent">
                    <div class="modal-overlay" @click="showCreateAgent = false"></div>
                    <div class="modal">
                        <h3>åˆ›å»ºæ–° Agent</h3>
                        <form @submit.prevent="createAgent">
                            <div class="form-group">
                                <label>åç§°</label>
                                <input v-model="newAgent.name" placeholder="Agent åç§°" required>
                            </div>
                            <div class="form-group">
                                <label>è§’è‰²</label>
                                <input v-model="newAgent.role" placeholder="å¦‚: ç ”ç©¶å‘˜ã€æ’°å†™è€…">
                            </div>
                            <div class="form-group">
                                <label>æè¿°</label>
                                <textarea v-model="newAgent.description" placeholder="æè¿°è¿™ä¸ª Agent çš„èŒè´£"></textarea>
                            </div>
                            <div class="form-group">
                                <label>ç±»å‹</label>
                                <select v-model="newAgent.agent_type">
                                    <option value="basic">åŸºç¡€ Agent</option>
                                    <option value="llm">LLM Agent</option>
                                </select>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn-secondary" @click="showCreateAgent = false">å–æ¶ˆ</button>
                                <button type="submit" class="btn-primary">åˆ›å»º</button>
                            </div>
                        </form>
                    </div>
                </div>
            </aside>

            <!-- ä¸­é—´: æ¶ˆæ¯å’Œäº¤äº’åŒº -->
            <section class="content">
                <!-- æ¶ˆæ¯æµ -->
                <div class="messages" ref="messagesContainer">
                    <div v-if="messages.length === 0" class="empty-state">
                        <div class="empty-icon">ğŸ’¬</div>
                        <p>è¿˜æ²¡æœ‰æ¶ˆæ¯ï¼Œå¼€å§‹åˆ›å»º Agent å¹¶å‘é€æ¶ˆæ¯å§ï¼</p>
                    </div>
                    
                    <div 
                        v-for="(msg, index) in messages" 
                        :key="index"
                        class="message"
                        :class="{ 'message-me': msg.sender === selectedAgent }"
                    >
                        <div class="message-header">
                            <span class="message-sender">{{ msg.sender }}</span>
                            <span class="message-receiver" v-if="msg.receiver !== 'all'">â†’ {{ msg.receiver }}</span>
                            <span class="message-receiver" v-else>â†’ å…¨éƒ¨</span>
                        </div>
                        <div class="message-content">{{ msg.content }}</div>
                        <div class="message-time">{{ formatTime(msg.timestamp) }}</div>
                    </div>
                </div>

                <!-- è¾“å…¥åŒº -->
                <div class="input-area">
                    <div class="input-row">
                        <select v-model="messageReceiver" class="receiver-select">
                            <option value="all">å¹¿æ’­ç»™æ‰€æœ‰</option>
                            <option v-for="agent in agents" :key="agent.name" :value="agent.name">
                                å‘é€ç»™ {{ agent.name }}
                            </option>
                        </select>
                        <input 
                            v-model="messageInput" 
                            @keyup.enter="sendMessage"
                            placeholder="è¾“å…¥æ¶ˆæ¯..."
                            class="message-input"
                        >
                        <button class="btn-send" @click="sendMessage">å‘é€</button>
                    </div>
                </div>
            </section>

            <!-- å³ä¾§: ä»»åŠ¡å’Œæ§åˆ¶é¢æ¿ -->
            <aside class="panel">
                <!-- ä»»åŠ¡æ‰§è¡Œ -->
                <div class="panel-section">
                    <h3>ä»»åŠ¡æ‰§è¡Œ</h3>
                    <div class="task-input">
                        <textarea v-model="taskInput" placeholder="è¾“å…¥è¦æ‰§è¡Œçš„ä»»åŠ¡..."></textarea>
                        <div class="task-actions">
                            <select v-model="taskAgent">
                                <option value="">é€‰æ‹© Agent</option>
                                <option v-for="agent in agents" :key="agent.name" :value="agent.name">
                                    {{ agent.name }}
                                </option>
                            </select>
                            <button class="btn-primary" @click="executeTask" :disabled="!taskAgent || !taskInput">
                                æ‰§è¡Œ
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ç¼–æ’å™¨ -->
                <div class="panel-section">
                    <h3>ç¼–æ’å™¨</h3>
                    <div class="orchestrator">
                        <textarea v-model="orchestratorTask" placeholder="è¾“å…¥å¤æ‚ä»»åŠ¡ï¼Œç¼–æ’å™¨ä¼šè‡ªåŠ¨åˆ†é…ç»™åˆé€‚çš„ Agent..."></textarea>
                        <select v-model="orchestratorStrategy">
                            <option value="auto">è‡ªåŠ¨åˆ†é…</option>
                            <option value="broadcast">å¹¿æ’­ä»»åŠ¡</option>
                            <option value="round_robin">è½®è¯¢åˆ†é…</option>
                        </select>
                        <button class="btn-primary" @click="runOrchestrator">æ‰§è¡Œç¼–æ’</button>
                    </div>
                </div>

                <!-- æ´»åŠ¨æ—¥å¿— -->
                <div class="panel-section">
                    <h3>æ´»åŠ¨æ—¥å¿—</h3>
                    <div class="logs">
                        <div v-for="(log, index) in activityLogs" :key="index" class="log-item" :class="log.type">
                            <span class="log-time">{{ formatTime(log.timestamp) }}</span>
                            <span class="log-message">{{ log.message }}</span>
                        </div>
                    </div>
                </div>
            </aside>
        </main>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>